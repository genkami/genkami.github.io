---
layout: post
title: stackでプロファイリングを有効にしてビルドする
tags:
- Haskell

---
{% raw %}
<p>以下のようにオプションを渡せば、stackでもプロファイリングを有効にしてビルドすることができます。</p>
<pre class="code lang-sh" data-lang="sh" data-unlink>$ stack build <span class="synSpecial">--executable-profiling</span> <span class="synSpecial">--library-profiling</span> <span class="synSpecial">--ghc-options=</span><span class="synStatement">&quot;</span><span class="synConstant">-fprof-auto -rtsopts</span><span class="synStatement">&quot;</span>
</pre><p>あと、実行時にも1つハマりどころがあります。ビルドした<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%D0%A5%A4">バイ</a>ナリを<a class="keyword" href="http://d.hatena.ne.jp/keyword/RTS">RTS</a>オプションを付けて実行したい場合、</p>
<pre class="code lang-sh" data-lang="sh" data-unlink>$ stack <span class="synStatement">exec</span> my-executable <span class="synSpecial">+RTS</span> <span class="synSpecial">-p</span>
</pre><p>のようにすると、+<a class="keyword" href="http://d.hatena.ne.jp/keyword/RTS">RTS</a>以下がstack自身に渡されてしまいます。したがって、ビルドした<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%D0%A5%A4">バイ</a>ナリ自体をプロファイリングしたい場合は、</p>
<pre class="code lang-sh" data-lang="sh" data-unlink>$ stack <span class="synStatement">exec</span> my-executable <span class="synSpecial">--</span> <span class="synSpecial">+RTS</span> <span class="synSpecial">-p</span>
</pre><p>のようにしなければなりません。</p>


{% endraw %}
