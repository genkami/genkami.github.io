---
layout: post
title: 書き初めQuineを書きました
tags:
- JavaScript

---
{% raw %}
<p>皆様、明けましておめでとうございます。<br />
新年早々インフルエンザに罹り、意図せず寝正月を送っていたのですが、そろそろ体調がよくなってきたので書き初めでもしてみようかと思います。</p>
<pre class="code lang-javascript" data-lang="javascript" data-unlink>eval(x=<span class="synConstant">&quot;c=($)=&gt;String.fromCharCode($);q=c(34);b=c(92);s=c(59);n=c(10);sp=c(32);hs=c(3\</span>
5############);pd=(_)=&gt;_&lt;10?<span class="synConstant">'0'</span>+_:<span class="synConstant">''</span>+_;fm=<span class="synIdentifier">{</span><span class="synConstant">'!'</span>:<span class="synIdentifier">[</span>0,6,12,24,0,192<span class="synIdentifier">]}</span>;<span class="synType">Array</span>.prototype.$=A<span class="synIdentifier">\</span>
r##  ####  ##ray.prototype.push;fm.E=<span class="synIdentifier">[]</span>;fm.E.$(0);fm.E.$(255);fm.E.$(192);fm.E.$(255)<span class="synIdentifier">\</span>
;##  ####  ##fm.E.$(192);fm.E.$(255);fm.E.$(0);fm.H=<span class="synIdentifier">[]</span>;fm.H.$(0);fm.H.$(195);fm.H.$(1<span class="synIdentifier">\</span>
9##        ##5);fm.H.$(255);fm.H.$(195);fm.H.$(195);fm.H.$(0);ms=<span class="synIdentifier">[</span>72,65,80,80,89,78,6<span class="synIdentifier">\</span>
9##  ####  ##,87,89,69,65,82,33<span class="synIdentifier">]</span>.map(c).join(<span class="synConstant">''</span>);cr=00;nx=(cr+1)%ms.length;fm.A=<span class="synIdentifier">[]</span>;fm<span class="synIdentifier">\</span>
.##  ####  ##A.$(0);fm.A.$(126);fm.A.$(195);fm.A.$(255);fm.A.$(195);fm.A.$(195);fm.A.<span class="synIdentifier">\</span>
$############(0);x=x.replace(<span class="synConstant">'cr='</span>+pd(cr),<span class="synConstant">'cr='</span>+pd(nx));y=<span class="synConstant">'eval(x='</span>+q+x+q+<span class="synConstant">'.split('</span>+q<span class="synIdentifier">\</span>
+b+<span class="synConstant">'n'</span>+q+<span class="synConstant">').join('</span>+q+q+<span class="synConstant">').split('</span>+q+hs+q+<span class="synConstant">').join('</span>+q+q+<span class="synConstant">').split('</span>+q+sp+q+<span class="synConstant">').join('</span>+q+<span class="synIdentifier">\</span>
q+<span class="synConstant">'))'</span>;fm.R=<span class="synIdentifier">[]</span>;fm.R.$(0);fm.R.$(254);fm.R.$(195);fm.R.$(254);fm.R.$(195);fm.R.$(195);<span class="synIdentifier">\</span>
fm.R.$(0);l=y.length;i=0;p=(m)=&gt;process.stdout.write(m);fm.N=<span class="synIdentifier">[]</span>;fm.N.$(0);fm.N.$(227)<span class="synIdentifier">\</span>
;fm.N.$(211);fm.N.$(203);fm.N.$(199);fm.N.$(195);fm.N.$(0);cc=0;lc=0;fm.Y=<span class="synIdentifier">[]</span>;fm.Y.$(0<span class="synIdentifier">\</span>
);fm.Y.$(231);fm.Y.$(102);fm.Y.$(60);fm.Y.$(24);fm.Y.$(24);fm.Y.$(0);wd=85;wb=1+12*(n<span class="synIdentifier">\</span>
x%7);hb=1+10*(Math.floor(nx/7));fm.W=<span class="synIdentifier">[</span>0,195,219,219,126,36,0<span class="synIdentifier">]</span>;wn=12;hn=7;fm.P=<span class="synIdentifier">[]</span>;fm.P<span class="synIdentifier">\</span>
.$(0);fm.P.$(254);fm.P.$(195);fm.P.$(254);fm.P.$(192);fm.P.$(192);fm.P.$(0);<span class="synStatement">while</span>(i&lt;l<span class="synIdentifier">\</span>
)<span class="synIdentifier">{</span><span class="synStatement">if</span>(cc==wd)<span class="synIdentifier">{</span><span class="synStatement">if</span>(i==l-1)<span class="synIdentifier">{</span>p(y<span class="synIdentifier">[</span>i<span class="synIdentifier">]</span>+n);<span class="synStatement">break</span>;<span class="synIdentifier">}</span><span class="synStatement">else</span><span class="synIdentifier">{</span>p(b+n);cc=0;lc++;<span class="synStatement">continue</span>;<span class="synIdentifier">}}</span><span class="synStatement">if</span>(hb&lt;=lc&amp;&amp;<span class="synIdentifier">\</span>
lc&lt;hb+hn&amp;&amp;wb&lt;=cc&amp;&amp;cc&lt;wb+wn)<span class="synIdentifier">{</span>w=cc-wb;h=lc-hb;<span class="synStatement">if</span>(w&lt;2||10&lt;=w)<span class="synIdentifier">{</span>p(hs);cc++;<span class="synStatement">continue</span>;<span class="synIdentifier">}</span><span class="synStatement">else</span><span class="synIdentifier">{\</span>
p(fm<span class="synIdentifier">[</span>ms<span class="synIdentifier">[</span>nx<span class="synIdentifier">]][</span>h<span class="synIdentifier">]</span>&amp;(1&lt;&lt;(7-w+2))?sp:hs);cc++;<span class="synStatement">continue</span>;<span class="synIdentifier">}}</span>p(y<span class="synIdentifier">[</span>i<span class="synIdentifier">]</span>);i++;cc++;<span class="synIdentifier">}</span>z=125;z+2356;z=<span class="synIdentifier">\</span>
++z;v=z+<span class="synConstant">'v'</span>;z*z+v;3258;<span class="synConstant">&quot;.split(&quot;</span><span class="synIdentifier">\</span>n<span class="synConstant">&quot;).join(&quot;&quot;).split(&quot;</span>#<span class="synConstant">&quot;).join(&quot;&quot;).split(&quot;</span> <span class="synConstant">&quot;).join(&quot;&quot;))</span>
</pre><p>書き初めです。<br />
こうしてみるとあまりよくわかりませんね。<br />
端末で開くとこのように見えます。<br />
<span itemscope itemtype="http://schema.org/Photograph"><img src="/img/post/2017-01-06-https-cdn-ak.f.st-hatena.com-images-fotolife-c-cloudear8-20170106-20170106072810.png" alt="f:id:cloudear8:20170106072810p:plain" title="f:id:cloudear8:20170106072810p:plain" class="hatena-fotolife" itemprop="image"></span><br />
<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%BD%A1%BC%A5%B9%A5%B3%A1%BC%A5%C9">ソースコード</a>の左上のほうにでっかく「H」と書いてありますね。</p><p>このプログラムはnode.jsで動く<a class="keyword" href="http://d.hatena.ne.jp/keyword/JavaScript">JavaScript</a>になっています。実行してみると、以下のように出力されます。<br />
<span itemscope itemtype="http://schema.org/Photograph"><img src="/img/post/2017-01-06-https-cdn-ak.f.st-hatena.com-images-fotolife-c-cloudear8-20170106-20170106073249.png" alt="f:id:cloudear8:20170106073249p:plain" title="f:id:cloudear8:20170106073249p:plain" class="hatena-fotolife" itemprop="image"></span><br />
先ほどの「H」が「A」に変わりました。位置も少し動いています。</p><p>この出力もプログラムになっていて、ちゃんと実行することができます。<br />
<span itemscope itemtype="http://schema.org/Photograph"><img src="/img/post/2017-01-06-https-cdn-ak.f.st-hatena.com-images-fotolife-c-cloudear8-20170106-20170106073459.png" alt="f:id:cloudear8:20170106073459p:plain" title="f:id:cloudear8:20170106073459p:plain" class="hatena-fotolife" itemprop="image"></span><br />
今度はPになりました。</p><p>さらにひたすら実行し続けます。<br />
<span itemscope itemtype="http://schema.org/Photograph"><img src="/img/post/2017-01-06-https-cdn-ak.f.st-hatena.com-images-fotolife-c-cloudear8-20170106-20170106073549.png" alt="f:id:cloudear8:20170106073549p:plain" title="f:id:cloudear8:20170106073549p:plain" class="hatena-fotolife" itemprop="image"></span><br />
<span itemscope itemtype="http://schema.org/Photograph"><img src="/img/post/2017-01-06-https-cdn-ak.f.st-hatena.com-images-fotolife-c-cloudear8-20170106-20170106073556.png" alt="f:id:cloudear8:20170106073556p:plain" title="f:id:cloudear8:20170106073556p:plain" class="hatena-fotolife" itemprop="image"></span><br />
<span itemscope itemtype="http://schema.org/Photograph"><img src="/img/post/2017-01-06-https-cdn-ak.f.st-hatena.com-images-fotolife-c-cloudear8-20170106-20170106073603.png" alt="f:id:cloudear8:20170106073603p:plain" title="f:id:cloudear8:20170106073603p:plain" class="hatena-fotolife" itemprop="image"></span><br />
<span itemscope itemtype="http://schema.org/Photograph"><img src="/img/post/2017-01-06-https-cdn-ak.f.st-hatena.com-images-fotolife-c-cloudear8-20170106-20170106073609.png" alt="f:id:cloudear8:20170106073609p:plain" title="f:id:cloudear8:20170106073609p:plain" class="hatena-fotolife" itemprop="image"></span><br />
<span itemscope itemtype="http://schema.org/Photograph"><img src="/img/post/2017-01-06-https-cdn-ak.f.st-hatena.com-images-fotolife-c-cloudear8-20170106-20170106073616.png" alt="f:id:cloudear8:20170106073616p:plain" title="f:id:cloudear8:20170106073616p:plain" class="hatena-fotolife" itemprop="image"></span><br />
<span itemscope itemtype="http://schema.org/Photograph"><img src="/img/post/2017-01-06-https-cdn-ak.f.st-hatena.com-images-fotolife-c-cloudear8-20170106-20170106073623.png" alt="f:id:cloudear8:20170106073623p:plain" title="f:id:cloudear8:20170106073623p:plain" class="hatena-fotolife" itemprop="image"></span><br />
<span itemscope itemtype="http://schema.org/Photograph"><img src="/img/post/2017-01-06-https-cdn-ak.f.st-hatena.com-images-fotolife-c-cloudear8-20170106-20170106073629.png" alt="f:id:cloudear8:20170106073629p:plain" title="f:id:cloudear8:20170106073629p:plain" class="hatena-fotolife" itemprop="image"></span><br />
<span itemscope itemtype="http://schema.org/Photograph"><img src="/img/post/2017-01-06-https-cdn-ak.f.st-hatena.com-images-fotolife-c-cloudear8-20170106-20170106073635.png" alt="f:id:cloudear8:20170106073635p:plain" title="f:id:cloudear8:20170106073635p:plain" class="hatena-fotolife" itemprop="image"></span><br />
<span itemscope itemtype="http://schema.org/Photograph"><img src="/img/post/2017-01-06-https-cdn-ak.f.st-hatena.com-images-fotolife-c-cloudear8-20170106-20170106073642.png" alt="f:id:cloudear8:20170106073642p:plain" title="f:id:cloudear8:20170106073642p:plain" class="hatena-fotolife" itemprop="image"></span><br />
<span itemscope itemtype="http://schema.org/Photograph"><img src="/img/post/2017-01-06-https-cdn-ak.f.st-hatena.com-images-fotolife-c-cloudear8-20170106-20170106073648.png" alt="f:id:cloudear8:20170106073648p:plain" title="f:id:cloudear8:20170106073648p:plain" class="hatena-fotolife" itemprop="image"></span></p><p>「H」→「A」→「P」→「P」→「Y」→「N」→「E」→「W」→「Y」→「E」→「A」→「R」→「!」</p><p>そうです。このプログラムは、実行すると順に1文字ずつ文字が埋め込まれた<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%BD%A1%BC%A5%B9%A5%B3%A1%BC%A5%C9">ソースコード</a>を出力し、最終的に「HAPPY NEW YEAR!」と出力するプログラムになっています。</p><p>ちなみに、「!」のコードをさらに実行してみると、最初に戻ります。<br />
<span itemscope itemtype="http://schema.org/Photograph"><img src="/img/post/2017-01-06-https-cdn-ak.f.st-hatena.com-images-fotolife-c-cloudear8-20170106-20170106074314.png" alt="f:id:cloudear8:20170106074314p:plain" title="f:id:cloudear8:20170106074314p:plain" class="hatena-fotolife" itemprop="image"></span><br />
このコードは最初の書き初めと全く同一のコードです。試しにdiffを取ってみましょう。<br />
<span itemscope itemtype="http://schema.org/Photograph"><img src="/img/post/2017-01-06-https-cdn-ak.f.st-hatena.com-images-fotolife-c-cloudear8-20170106-20170106074351.png" alt="f:id:cloudear8:20170106074351p:plain" title="f:id:cloudear8:20170106074351p:plain" class="hatena-fotolife" itemprop="image"></span><br />
不思議ですね。でも、コツを掴むと意外と簡単に書けます。</p>


{% endraw %}
