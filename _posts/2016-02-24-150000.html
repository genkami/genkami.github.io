---
layout: post
title: ScalaFXでデフォルトのCSSが見当たらない
tags:
- Scala

---
{% raw %}
<p>ScalaFXの練習として、とりあえず公式にあるサンプルを写経していた所、次のような現象に遭遇しました。</p><p>問題になったコードは以下の通り。ほぼ下記のサイトのコードそのままです。<br />
<a href="http://www.scalafx.org/docs/faq_TableView_with_Custom_cell/">http://www.scalafx.org/docs/faq_TableView_with_Custom_cell/</a><br />
</p>
<pre class="code lang-scala" data-lang="scala" data-unlink><span class="synPreProc">import</span> scalafx.application.JFXApp
<span class="synPreProc">import</span> scalafx.application.JFXApp.PrimaryStage
<span class="synPreProc">import</span> scalafx.beans.property.{StringProperty, ObjectProperty}
<span class="synPreProc">import</span> scalafx.collections.ObservableBuffer
<span class="synPreProc">import</span> scalafx.scene.Scene
<span class="synPreProc">import</span> scalafx.scene.control.TableColumn._
<span class="synPreProc">import</span> scalafx.scene.control.{TableCell, TableColumn, TableView}
<span class="synPreProc">import</span> scalafx.scene.paint.Color
<span class="synPreProc">import</span> scalafx.scene.shape.Circle

<span class="synType">class</span> Person(firstName_ : <span class="synConstant">String</span>, 
             lastName_ : <span class="synConstant">String</span>, 
             favoriteColor_ : Color) {
  <span class="synType">val</span> firstName = <span class="synStatement">new</span> StringProperty(<span class="synType">this</span>, <span class="synConstant">&quot;firstName&quot;</span>, firstName_)
  <span class="synType">val</span> lastName = <span class="synStatement">new</span> StringProperty(<span class="synType">this</span>, <span class="synConstant">&quot;lastName&quot;</span>, lastName_)
  <span class="synType">val</span> favoriteColor = <span class="synStatement">new</span> ObjectProperty(<span class="synType">this</span>, <span class="synConstant">&quot;favoriteColor&quot;</span>, 
                                         favoriteColor_)
}

<span class="synType">object</span> TableWithCustomCellDemo <span class="synType">extends</span> JFXApp {

  <span class="synType">val</span> characters = ObservableBuffer[Person](
    <span class="synStatement">new</span> Person(<span class="synConstant">&quot;Peggy&quot;</span>, <span class="synConstant">&quot;Sue&quot;</span>, Color.Violet),
    <span class="synStatement">new</span> Person(<span class="synConstant">&quot;Rocky&quot;</span>, <span class="synConstant">&quot;Raccoon&quot;</span>, Color.GreenYellow),
    <span class="synStatement">new</span> Person(<span class="synConstant">&quot;Bungalow &quot;</span>, <span class="synConstant">&quot;Bill&quot;</span>, Color.DarkSalmon)
  )

  stage = <span class="synStatement">new</span> PrimaryStage {
    title = <span class="synConstant">&quot;TableView with custom color cell&quot;</span>
    scene = <span class="synStatement">new</span> Scene {
      content = <span class="synStatement">new</span> TableView[Person](characters) {
        columns ++= List(
          <span class="synStatement">new</span> TableColumn[Person, <span class="synConstant">String</span>] {
            text = <span class="synConstant">&quot;First Name&quot;</span>
            cellValueFactory = { _.value.firstName }
            prefWidth = <span class="synConstant">100</span>
          },
          <span class="synStatement">new</span> TableColumn[Person, <span class="synConstant">String</span>]() {
            text = <span class="synConstant">&quot;Last Name&quot;</span>
            cellValueFactory = { _.value.lastName }
            prefWidth = <span class="synConstant">100</span>
          },
          <span class="synStatement">new</span> TableColumn[Person, Color] {
            text = <span class="synConstant">&quot;Favorite Color&quot;</span>
            cellValueFactory = { _.value.favoriteColor }
            cellFactory = { _ =&gt; 
              <span class="synStatement">new</span> TableCell[Person, Color] {
                item.onChange { (_, _, newColor) =&gt; 
                  graphic = <span class="synStatement">new</span> Circle {fill = newColor; radius = <span class="synConstant">8</span>}
                }
              }
            }
            prefWidth = <span class="synConstant">100</span>
          }
        )
      }
    }
  }
}
</pre><p>これを実行すると、次のような画面が表示されます。</p><p><span itemscope itemtype="http://schema.org/Photograph"><img src="http://cdn-ak.f.st-hatena.com/images/fotolife/c/cloudear8/20160223/20160223085301.png" alt="f:id:cloudear8:20160223085301p:plain" title="f:id:cloudear8:20160223085301p:plain" class="hatena-fotolife" itemprop="image"></span></p><p>やたらとしょぼい表示ですが、一応TableViewによる表の表示ができています。<br />
ところで、これを公式のサンプルにある<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%B9%A5%AF%A5%EA%A1%BC%A5%F3%A5%B7%A5%E7%A5%C3%A5%C8">スクリーンショット</a>と見比べてみましょう。</p><p><span itemscope itemtype="http://schema.org/Photograph"><img src="http://cdn-ak.f.st-hatena.com/images/fotolife/c/cloudear8/20160223/20160223085516.png" alt="f:id:cloudear8:20160223085516p:plain" title="f:id:cloudear8:20160223085516p:plain" class="hatena-fotolife" itemprop="image"></span></p><p>……<br />
なんだこのクオリティの差は……。<br />
(※画像はイメージです)って小さく書かれてたとしてもキレるレベルですねこれは。</p><p>さらにログをよく見てみると、このウィンドウを表示する際に以下のようなwarningが出ていることに気付きました。</p>

<pre>2 23, 2016 8:37:43 午前 com.sun.<a class="keyword" href="http://d.hatena.ne.jp/keyword/javafx">javafx</a>.<a class="keyword" href="http://d.hatena.ne.jp/keyword/css">css</a>.StyleManager loadStylesheetUnPrivileged
WARNING: Resource "com/sun/<a class="keyword" href="http://d.hatena.ne.jp/keyword/javafx">javafx</a>/scene/control/skin/modena/modena.<a class="keyword" href="http://d.hatena.ne.jp/keyword/css">css</a>" not found.
</pre><p><a class="keyword" href="http://d.hatena.ne.jp/keyword/javafx">javafx</a>で用意されているデフォルトの<a class="keyword" href="http://d.hatena.ne.jp/keyword/CSS">CSS</a>ファイルらしきものをうまく読み込めていないようです。<br />
調べてみると、<a class="keyword" href="http://d.hatena.ne.jp/keyword/JavaFX">JavaFX</a>のjarファイルの位置がJava8で変更になったにも関わらず、sbt側がそれを検知できていないことが原因のようです。<br />
元のパスは"$<a class="keyword" href="http://d.hatena.ne.jp/keyword/JAVA">JAVA</a>_HOME/<a class="keyword" href="http://d.hatena.ne.jp/keyword/jre">jre</a>/lib/jfxrt.jar"、変更先は"$<a class="keyword" href="http://d.hatena.ne.jp/keyword/JAVA">JAVA</a>_HOME/<a class="keyword" href="http://d.hatena.ne.jp/keyword/jre">jre</a>/lib/ext/jfxrt.jar"ということなので、build.sbtに以下を追記</p>
<pre class="code lang-scala" data-lang="scala" data-unlink>lazy <span class="synType">val</span> root = (project in file(<span class="synConstant">&quot;.&quot;</span>)).
  settings(
    <span class="synComment">// ...(その他の設定)</span>
    unmanagedJars in Compile += {
        <span class="synType">val</span> ps = <span class="synStatement">new</span> sys.SystemProperties
        <span class="synType">val</span> jh = ps(<span class="synConstant">&quot;java.home&quot;</span>)
        Attributed.blank(file(jh) / <span class="synConstant">&quot;lib/ext/jfxrt.jar&quot;</span>)
    }
  )
</pre><p>sbt runすると、ちゃんとmodena.<a class="keyword" href="http://d.hatena.ne.jp/keyword/css">css</a>が読み込まれていることが確認できます。</p><p><span itemscope itemtype="http://schema.org/Photograph"><img src="http://cdn-ak.f.st-hatena.com/images/fotolife/c/cloudear8/20160223/20160223090731.png" alt="f:id:cloudear8:20160223090731p:plain" title="f:id:cloudear8:20160223090731p:plain" class="hatena-fotolife" itemprop="image"></span></p><p><div class="hatena-asin-detail"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/4864873798/cloudear-22/"><img src="http://ecx.images-amazon.com/images/I/41Rr1Iv8lhL._SL160_.jpg" class="hatena-asin-detail-image" alt="Scalaファンクショナルデザイン ―関数型プログラミングの設計と理解" title="Scalaファンクショナルデザイン ―関数型プログラミングの設計と理解"></a><div class="hatena-asin-detail-info"><p class="hatena-asin-detail-title"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/4864873798/cloudear-22/">Scalaファンクショナルデザイン ―関数型プログラミングの設計と理解</a></p><ul><li><span class="hatena-asin-detail-label">作者:</span> 深井裕二</li><li><span class="hatena-asin-detail-label">出版社/メーカー:</span> 三恵社</li><li><span class="hatena-asin-detail-label">発売日:</span> 2015/05/29</li><li><span class="hatena-asin-detail-label">メディア:</span> 単行本（ソフトカバー）</li><li><a href="http://d.hatena.ne.jp/asin/4864873798/cloudear-22" target="_blank">この商品を含むブログを見る</a></li></ul></div><div class="hatena-asin-detail-foot"></div></div><div class="hatena-asin-detail"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/4877833765/cloudear-22/"><img src="http://ecx.images-amazon.com/images/I/51sqlqiwgpL._SL160_.jpg" class="hatena-asin-detail-image" alt="JavaFX & Java8プログラミング―Javaによる新しいGUIプログラミング入門" title="JavaFX & Java8プログラミング―Javaによる新しいGUIプログラミング入門"></a><div class="hatena-asin-detail-info"><p class="hatena-asin-detail-title"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/4877833765/cloudear-22/">JavaFX & Java8プログラミング―Javaによる新しいGUIプログラミング入門</a></p><ul><li><span class="hatena-asin-detail-label">作者:</span> 日向俊二</li><li><span class="hatena-asin-detail-label">出版社/メーカー:</span> カットシステム</li><li><span class="hatena-asin-detail-label">発売日:</span> 2015/08</li><li><span class="hatena-asin-detail-label">メディア:</span> 単行本</li><li><a href="http://d.hatena.ne.jp/asin/4877833765/cloudear-22" target="_blank">この商品を含むブログを見る</a></li></ul></div><div class="hatena-asin-detail-foot"></div></div></p>


{% endraw %}
